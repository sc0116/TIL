# 아이템 81. wait와 notify보다는 동시성 유틸리티를 애용하자

## 동시성 유틸리티를 사용하자!

자바 5에서 고수준의 동시성 유틸리티가 도입되었다.  
동시성 유틸리티가 `wait`과 `notify`를 이용해서 직접 구현해야 했던 작업들을 제공한다.  
그러니까 어렵게 `wait`과 `notify` 사용하지 말구 동시성 유틸리티를 사용하자!

## 동시성 유틸리티

`java.util.concurrent` 패키지는 고수준 동시성 유틸리티를 제공한다.
- 실행자 프레임워크
- 동시성 컬렉션
- 동기화 장치

## 동시성 컬렉션

`List`, `Queue`, `Map` 같은 표준 컬렉션 인터페이스에 동시성을 추가해 구현한 컬렉션
- 고수준 동시성을 위해 내부적으로 동기화를 수행한다.
- 따라서 별도로 lock을 걸어도 느려지기만 할 뿐 효과는 없다.

### 동시성 컬렉션의 장점

#### 1. 빠른 처리 속도

동기화한 컬렉션인 `Collections.synchronizedMap`을 이용하는 것보다 동시적 컬렉션인 `ConcurrentHashMap`을 이용하는 것이 성능면에서 훨씬 좋다.

#### 2. 상태 의존적 수정 연산 지원

여러 개의 기본 연산을 결합하여 단일 연산으로 묶는 것을 의미한다.  
자바 8에서 일반 컬렉션 인터페이스에도 디폴트 메서드로 추가되었다.

##### putIfAbsent

`containsKey`와 `put` 메서드를 결합하여 만든 메서드

```java
//ConcurrentMap - putIfAbsent(key, value)
if (!map.containsKey(key))
    return map.put(key, value);
else
    return map.get(key);
```

직접 구현하는 것보다 상태 의존적 수정 연산(`putIfAbsent`)를 이용하는 것이 좋다.

#### 3. 블록 연산

작업이 성공적으로 수행될 때까지 대기 또는 블록 처리되는 연산을 의미한다.
