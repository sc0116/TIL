# 2장. 이상한 나라의 객체

---

> 객체지향 패러다임은 지식을 추상화하고 추상화한 지식을 객체 안에 캡슐화함으로써 실세계 문제에 내재된 복잡성을 관리하려고 한다.  
> 객체를 발견하고 창조하는 것은 지식과 행동을 구조화하는 문제다. - 레베카 워프스브록

## 1. 객체지향과 인지 능력

---

객체란 인간이 분명하게 인지하고 구별할 수 있는 물리적인 또는 개념적인 경계를 지닌 어떤 것이다.  

객체지향 패러다임은 소프트웨어의 세계가 인간이 인지할 수 있는  
다양한 소프트웨어 객체들이 모여 이뤄져 있다는 믿음에서 출발한다.

그러나 현실 세계와 소프트웨어 세계는 본질적으로는 매우 다르다.
- 현실 세계에서는 사람이 직접 주문 금액 계산하지만,  
  소프트웨어 세계에서는 주문 객체가 자신의 금액을 계산한다.
- 현실 세계의 전등은 사람의 손길 없이는 스스로 불을 밝힐 수 없지만,  
  소프트웨어 세계의 전등은 외부의 도움 없이도 스스로 전원을 켜거나 끌 수 있다.
  
## 2. 객체, 그리고 이상한 나라

---

### 2-1. 이상한 나라의 앨리스

저자는 객체지향을 **이상한 나라의 앨리스** 동화책에 기초하여 설명한다.  

이상한 나라의 앨리스의 줄거리를 간략하게 살펴보자.

- 앨리스는 긴 통로에서 숨겨져 있던 작은 문을 발견했는데, 그 문 뒤에는 아름다운 정원이 펼쳐져 있었다.
- 문의 높이가 매우 낮았기 때문에 앨리스는 자신의 몸을 작게 만들 방법을 고민한다.
- 방법을 찾기 위해 주위를 돌러보던 중 몸이 작아지거나 커지게 하는 음식을 발견했다.
    - 병 속의 액체를 마시면 키가 작아진다.
    - 케이크를 먹으면 키가 커진다.
- 우여곡절 끝에 몸의 크기를 조절할 수 있는 버섯을 얻고, 문을 통과해 아름다운 정원으로 발길을 들여 놓을 수 있었다.

### 2-2. 앨리스 객체

앨리스는 **상태**를 가지며 상태는 **변경** 가능하다.
- 앨리스는 문을 통과하기에 적당한 상태로 키를 변화시켰다.
- 앨리스의 상태는 키와 위치다.

앨리스의 상태를 변화시킨 것은 앨리스의 **행동**이다.
- 앨리스의 키는 병 속의 액체를 마시거나 케이크를 먹는다라는 행동을 했을 때 변화한다.
- **앨리스의 상태를 결정하는 것은 행동이지만 행동의 결과를 결정하는 것은 상태다.**
    - 음식을 먹기 전 앨리스의 키가 얼마였느냐가 음식을 먹은 후의 앨리스 키를 결정한다.
    - 행동의 결과는 **상태에 의존적**이며 상태를 이용해 서술할 수 있다.
- **행동의 순서가 결과에 영향을 미친다.**
    - 앨리스는 문을 통과하는 행동이 성공하려면 음식을 먹는 행동이 선행돼야만 한다.

앨리스는 어떤 상태에 있더라도 유일하게 **식별** 가능하다.
- 행동에 의해 앨리스의 키(상태)가 변경되더라도 앨리스가 앨리스라는 사실은 변하지 않는다.

## 3. 객체, 그리고 소프트웨어 나라

---

객체는 **상태**, **행동**, **식별자**를 지닌다.

### 3-1. 상태

#### 왜 상태가 필요한가

객체가 주변 환경과의 상호작용에 어떻게 반응하는가는 그 시점까지 객체에 어떤 일이 발생했느냐에 좌우된다.  
- 어떤 행동의 결과는 과거에 어떤 행동들이 일어났었느냐에 의존한다는 것이다.

앨리스가 문을 통과하기 위해서는 자신의 키를 작게 줄여야만 한다.  
- 문을 통과한다는 행동의 결과를 예상할 수 있는 방법은 앨리스가 과거에 음식을 먹었던 적이 있는지 살펴보는 것이다.
- 하지만 과거에 발생한 행동의 이력을 통해 현재 발생한 행동의 결과를 판단하는 방식은 복잡하고 번거로우며 이해하기 어렵다.

따라서 **행동의 과정과 결과를 단순하게 기술하기 위해 상태라는 개념을 고안했다**.
- 상태를 이용하면 과거에 얽매이지 않고 현재를 기반으로 객체의 행동 방식을 이해할 수 있다.
- 앨리스의 키와 문의 높이라는 상태만 알면 문을 통과하는 행동의 결과를 쉽게 예측할 수 있는 것이다.

**상태는 근본적으로 세상의 복잡성을 완화하고 인지 과부하를 줄일 수 있는 중요한 개념이다.**

#### 상태와 프로퍼티

단순한 값은 객체가 아니지만 객체의 상태를 표현하기 위한 중요한 수단이다.  

떄로는 단순한 값이 아니라 객체를 사용해 다른 객체의 상태를 표현해야 할 때가 있다.  
- 앨리스가 현재 음료를 들고 있는 상태인 경우, 앨리스의 상태는 키, 위치 그리고 음료라는 객체의 조합으로 표현할 수 있다.
- 모든 객체의 상태는 단순한 값과 객체의 조합으로 표현할 수 있다.

객체의 상태를 구성하는 모든 특징을 통틀어 객체의 **프로퍼티**라고 한다.
- 앨리스의 경우 키, 위치, 음료가 해당된다.
- 프로퍼티는 정적인 반면, **프로퍼티 값**은 동적이다.

객체와 객체 사이의 의미 있는 연결을 **링크**라고 한다.
- 객체의 링크를 통해서만 메시지를 주고받을 수 있다.

객체 간의 선으로 표현되는 링크와 달리 객체를 구성하는 단순한 값은 **속성**이라고 한다.

### 3-2. 행동

#### 상태와 행동

객체의 상태를 변경하는 것은 객체의 자발적인 행동뿐이다.
- 앨리스가 특정한 행동을 취할 때마다 앨리스의 키와 위치가 변경된다.
- 객체의 행동에 의해 객체의 상태가 변경된다는 것은 행동이 **부수 효과**를 초래한다는 것을 의미한다.

상태와 행동 사이의 관계
- 객체의 행동은 상태에 영향을 받는다.
- 객체의 행동은 상태를 변경시킨다.

#### 협력과 행동

객체가 다른 객체와 협력하는 유일한 방법은 다른 객체에게 요청을 보내는 것이다.
- 객체는 다른 객체와 메시지를 통해서만 의사소통할 수 있다.
- 객체는 수신된 메시지에 따라 적절히 행동하면서 협력에 참여하고 그 결과로 자신의 상태를 변경한다.
- 객체는 협력에 참여하는 과정에서 자기 자신의 상태뿐만 아니라 다른 객체의 상태 변경을 유발할 수도 있다.

#### 상태 캡슐화

객체지향의 세계에서 모든 객체는 자신의 상태를 스스로 관리하는 자율적인 존재다.
- 현실 세계라면 음료는 스스로 아무것도 할 수 없는 수동적인 존재다.
- 객체지향 세계에서는 음료 객체의 양을 줄이는 것은 메시지를 전달받은 음료 스스로의 몫이다.
- 객체는 상태를 캡슐 안에 감춰둔 채 외부로 노출하지 않으며, 외부에 노출하는 것은 행동뿐이다.

상태를 잘 정의된 행동 집합 뒤로 캡슐화하는 것은 객체의 자율성을 높이고 협력을 단순하고 유연하게 만든다.  
이것이 상태를 캡슐화해야 하는 이유다.

### 3-3. 식별자

객체가 식별 가능하다는 것은 객체를 서로 구별할 수 있는 특정한 프로퍼티가 객체 안에 존재한다는 것을 의미한다.  
- 이 프로퍼티를 **식별자**라고 한다.
- 모든 객체는 식별자를 가지며 식별자를 이용해 객체를 구별할 수 있다.

**값**의 상태는 변하지 않기 때문에 불변 상태를 가진다고 말한다.
- 따라서 상태를 이용해 두 값이 같은지 판단할 수 있다.
- 이러한 성질을 **동등성**이라고 한다.

**객체**는 시간에 따라 변경되는 상태를 포함하며, 행동을 통해 상태르 변경한다.  
따라서 객체는 가변 상태를 가진다고 말한다.

타입이 같은 두 객체의 상태가 완전히 똑같더라도 두 객체는 독립적인 별개의 객체로 다뤄야 한다.
- 동명이인에 키도 동일하다고 해서 두 사람이 같은 사람은 아니다.
- 하지만 키도 작고 나이가 어린 과거의 나는 현재의 나와 동일한 인물이다.

객체는 두 객체의 상태가 다르더라도 식별자가 같다면 같은 객체로 판단할 수 있다.
- 식별자를 기반으로 객체가 같은지를 판단할 수 있는 성질을 **동일성**이라고 한다.

## 4. 기계로서의 객체

---

객체가 외부에 제공하는 행동의 대부분은 쿼리와 명령으로 구성된다.
- 객체의 상태를 조회하는 작업을 **쿼리**
- 객체의 상태를 변경하는 작업을 **명령**

사용자는 객체가 제공하는 명령과 쿼리로 구성된 인터페이스를 통해서만 객체에 접근할 수 있다.
- **캡슐화** 강조

## 5. 행동이 상태를 결정한다

---

객체의 상태를 먼저 결정하고 행동을 나중에 결정하는 경우 설계에 나쁜 영향을 끼친다.
- 첫째, 상태를 먼저 결정할 경우 캡슐화가 저해된다.
    - 상태에 초점을 맞출 경우 상태가 객체 내부로 깔끔하게 캡슐화되지 못하고 공용 인터페이스에 그대로 노출되버릴 확률이 높아진다.
- 둘째, 객체를 협력자가 아닌 고립된 섬으로 만든다.
    - 상태를 먼저 고려하는 방식은 협력이라는 문맥에서 멀리 벗어난 채 객체를 설계하게 함으로써 자연스럽게 협력에 적합하지 못한 객체를 창조하게 된다.
- 셋째, 객체의 재사용성이 저하된다.

**객체의 행동은 객체가 협력에 참여하는 유일한 방법이다.**  
- 객체의 적합성을 결정하는 것은 그 객체의 상태가 아니라 행동이다.  
- 따라서 먼저 객체의 행동을 결정하고 그 후에 행동에 적절한 상태를 선택하게 된다.

협력 안에서 객체의 행동은 객체가 협력에 참여하면서 완수해야 하는 책임을 의미한다.
- 따라서 어떤 책임이 필요한가를 결정하는 과정이 전체 설계를 주도해야 한다.
- **책임-주도 설계**는 협력이라는 문맥 안에서 객체의 행동을 생각하도록 도움으로써 응집도 높고 재사용 가능한 객체를 만들 수 있게 한다.

## 6. 은유와 객체

---

### 6-1. 의인화

현실 속의 객체와 소프트웨어 객체 사이의 가장 큰 차이점
- 현실 속에서는 수동적인 존재가 소프트웨어 객체로 구현될 때는 능동적으로 변한다는 것이다.
- 소프트웨어 객체가 현실 객체의 부분적인 특징을 모장하는 것이 아니라 현실 객체가 가지지 못한 추가적인 능력을 보유하게 된다.

현실의 객체보다 더 많은 일을 할 수 있는 소프트웨어 객체의 특징을 **의인화**라고 부른다.
- 심지어 현실 세계에는 존재하지 않는 것들도 소프트웨어 안에서는 객체가 될 수 있다.

### 6-2. 은유

현실 세계와 객체지향 세계는 **은유**의 관계를 가지고 있다.

은유란 실제로는 적용되지 않는 한 가지 개념을 이용해 다른 개념을 서술하는 대화의 한 형태다.
- 그 여자는 양 같아요, 그 남자는 사자 같아요

현실 속의 객체의 의미 일부가 소프트웨어 객체로 전달되기 때문에 프로그램 내의 객체는 현실 속의 객체에 대한 은유다.
- 비록 현실 속의 전화기는 스스로 전화를 걸 수 없다고 하더라도 우리가 익히 알고 있는 현실의 전화기라는 개념을 이용해 소프트웨어 객체를 묘사하면 그 객체가 전화를 걸 수 있다는 사실을 쉽게 이해하고 기억할 수 있게 된다.

소프트웨어 객체에 대한 현실 객체의 은유를 효과적으로 사용할 경우 표현적 차이를 줄일 수 있으며, 이해하기 쉽고 유지보수가 용이한 소프트웨어를 만들 수 있다.
- 이러한 이유로 객체지향 지침서에는 현실 세계인 도메인에서 사용되는 이름을 객체에 부여하라고 가이드하는 것이다.
