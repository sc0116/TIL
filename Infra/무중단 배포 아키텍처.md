중단 배포 방식은 애플리케이션이 업데이트 되고, 이를 운영 환경에 배포할 경우 배포하는 시간 동안 서비스가 중지되는 다운타임(Downtime)이 발생할 수 밖에 없다. 
사용자가 여러 시간 대에 자주 이용하는 서비스라면, 배포할 때마다 사용자에게 잠깐의 서비스 중단이라는 불편을 불러올 수 있다. 

이런 문제를 해결하기 위해 서비스와 사용자에게 부정적인 영향을 최소화하는 좋은 대안이 될 수 있는 무중단 배포라는 개념이 나왔다.

# 무중단 배포(Zero-downtime Deployment)
무중단 배포는 서비스 장애와 배포의 부담을 최소화하기 위해 운영 중인 서비스를 중단하지 않고 신규 소프트웨어를 배포하는 기술이다.

## 롤링 배포(Rolling Deployment)
롤링 배포는 무중단 배포의 가장 기본적인 방식으로, 사용 중인 인스턴스 내에서 구버전에서 신버전을 점진적으로 교체하는 방식이다. 
서비스 중인 인스턴스 하나를 로드 밸런서에서 라우팅하지 않도록 한 뒤, 새 버전을 적용하여 다시 라우팅하도록 한다. 
이 과정을 반복하여 모든 인스턴스에 새 버전의 애플리케이션을 배포한다.

![rolling-deployment](https://user-images.githubusercontent.com/47477359/211563613-185f7bc2-3b4a-49f7-88df-04f6a8face2b.gif)

### 장점
- 인스턴스를 추가로 늘리지 않아도 무중단 배포가 가능하다.
- 인스턴스마다 차례로 배포를 진행하기 때문에 상황에 따라 손쉽게 롤백이 가능하다.

### 단점
- 인스턴스가 제한적인 경우에 사용되며 새 버전을 배포할 때 인스턴스 수가 감소하기 때문에 적은 수의 인스턴스가 부담하는 트래픽의 양이 늘어날 수 있다.
- 배포가 진행되는 동안 구버전 신버전이 공존하기 때문에 호환성 문제가 발생할 수 있다.

## 블루-그린 배포(Blue-Green Deployment)
블루-그린 배포는 운영 환경에 구버전과 동일하게 신버전의 인스턴스를 구성한 후, 로드밸런서를 통해 신버전으로 한번에 모든 트래픽을 전환하는 방식이다. 
현재 운영중인 서비스 버전을 블루라고 부르고, 새롭게 배포될 버전을 그린이라고 부른다. 

![blue-green-deployment](https://user-images.githubusercontent.com/47477359/211563623-aa946cd7-2fcb-401d-9924-d962695f4a15.gif)

### 장점
- 트래픽을 한번에 신버전으로 옮기기 때문에 호환성 문제가 발생하지 않는다.
- 구버전의 인스턴스가 남아 있어서 손쉽게 롤백이 가능하다.
- 구버전의 환경을 다음 배포에 재사용할 수 있다.

### 단점
- 새로운 환경에 대한 테스트가 전제되어야 한다.
- 시스템 자원이 실제 운영에 필요한 서버 자원의 두 배가 필요하다.

## 카나리 배포(Canary Deployment)
카나리 배포는 신버전에 대한 잠재적 문제 상황을 미리 발견하기 위한 방식으로, 신버전을 소수의 유저들에게만 배포하고 신버전에 이상이 없는 것을 확인해가며 점차 많은 사용자들에게 배포하는 방식이다. 
신버전의 제공 범위를 늘려가면서 모니터링 및 피드백 과정을 거칠 수 있다.

![canary-deployment-3f4cfe177dc1d0b6c632c85521ad0b6d](https://user-images.githubusercontent.com/47477359/211563633-2ec2adba-f7d0-433c-887d-261dc7507ef8.gif)

로드 밸런서를 통해 신버전의 제품을 경험하는 사용자를 조절할 수 있다. 
이러한 특징으로 인해 A/B 테스트를 진행하기에도 적합한 방식이다.

카나리 배포는 블루-그린 배포와 유사하지만 한번에 모두 바꾸는 것이 아니라 단계적인 전환 방식을 통해 부정적 영향을 최소화하고 상황에 따라 트래픽 양을 늘리거나 롤백할 수 있다.

## 참고
- [https://hudi.blog/zero-downtime-deployment/](https://hudi.blog/zero-downtime-deployment/) - 사진 출처 및 참고
- [https://www.samsungsds.com/kr/insights/1256264_4627.html](https://www.samsungsds.com/kr/insights/1256264_4627.html)
